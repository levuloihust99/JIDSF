# NER

## Step 1. Prepare data

```shell
python -m scripts.prepare_ner_data
```

After running this command, a file `data/ner/all.jsonl` is generated. This file has the expected format for training NER.

Train/dev splits are determined using two files `data/ner/train_indices.json` and `data/ner/dev_indices.json`. These two files are generated by running:

```shell
python -m scripts.split_train_test --input_file data/ner/all.jsonl --output_dir data/ner --split_ratio "[0.75, 0.25]"
```

For reproducibility, we provide these two files in the Docker image. Thus, there is no need to run train/test split yourself.

## Step 2. Run train

```shell
bash run_train_ner.sh
```

Running this command performs NER training. On our computer (Kaggle P100), we got a checkpoint `checkpoints/ner-hackathon-2023/vibert4news-base-cased/Q0JNCHRAN7RGZBZB/checkpoint-BertPosTagger-5e-05-0.994814`. We provide this checkpoint for reproducibility.

## Step 3. Infer

```shell
bash run_infer_ner.sh
```

To successfully run this command, we need ASR output to be placed at `results/asr_output_norm.json`. After running this command, a file `results/NER.jsonl` is generated.

# Intent classification

## Step 1. Run train

```shell
bash train_IC.sh
```

Running this command performs intent classifier training. On our computer, we got a checkpoint `checkpoints/IC/checkpoint-BertForSequenceClassification-5e-05-0.995729`. We provide this checkpoint for reproducibility.

## Step 2. Infer

```shell
bash run_infer_IC.sh
```

To successfully run this command, we need ASR output to be placed at `results/asr_output_norm.json`. After running this command, a file `results/intent_classification.jsonl` is generated.

# Submission

```shell
python merge_result.py
```

After running this command, a file `results/predictions.jsonl` is generated, which is ready for submission.